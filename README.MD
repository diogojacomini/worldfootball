# World Football Data Pipeline âš½

Um pipeline de dados completo para extraÃ§Ã£o, transformaÃ§Ã£o e carregamento de dados do Campeonato Brasileiro SÃ©rie A, implementado com Azure Functions e Python.

## ğŸ—ï¸ Arquitetura

Este projeto implementa uma arquitetura ETL moderna usando Azure Functions serverless para processar dados de futebol em tempo real:

```
[worldfootball.net] â†’ [Azure Functions] â†’ [Azure Blob Storage] â†’ [API REST]
```

### Componentes Principais

- **`fnt_extraction`**: ExtraÃ§Ã£o de dados da worldfootball.net
- **`fnt_transformation`**: TransformaÃ§Ã£o e limpeza dos dados
- **`fnt_load`**: Carregamento para storage definitivo
- **`getwf`**: API REST para consulta dos dados processados
- **`fnt_parametrizacao`**: ConfiguraÃ§Ã£o e parametrizaÃ§Ã£o do pipeline

## ğŸš€ Funcionalidades

- âœ… ExtraÃ§Ã£o automatizada de dados do BrasileirÃ£o SÃ©rie A
- âœ… Pipeline ETL completo com controle de status
- âœ… API REST para consulta de dados consolidados
- âœ… Armazenamento em camadas (Raw, Processed, Curated)
- âœ… Controle de execuÃ§Ã£o e retry automÃ¡tico
- âœ… Deploy automatizado via GitHub Actions
- âœ… Monitoramento e logging detalhado

## ğŸ“Š Dados ExtraÃ­dos

O pipeline coleta e processa:
- PosiÃ§Ã£o na tabela
- Nome dos times
- EstatÃ­sticas por rodada (vitÃ³rias, empates, derrotas)
- Gols marcados e sofridos
- DiferenÃ§a de gols
- PontuaÃ§Ã£o total
- Dados histÃ³ricos por temporada

## ğŸ› ï¸ Stack TecnolÃ³gica

- **Python 3.9+** - Linguagem principal
- **Azure Functions** - ComputaÃ§Ã£o serverless
- **Azure Blob Storage** - Data Lake
- **Pandas** - Processamento de dados
- **Requests + lxml** - Web scraping
- **GitHub Actions** - CI/CD

## ğŸ“ Estrutura do Projeto

```
worldfootball/
â”œâ”€â”€ fnt_extraction/          # FunÃ§Ã£o de extraÃ§Ã£o
â”œâ”€â”€ fnt_transformation/      # FunÃ§Ã£o de transformaÃ§Ã£o  
â”œâ”€â”€ fnt_load/               # FunÃ§Ã£o de carregamento
â”œâ”€â”€ fnt_parametrizacao/     # FunÃ§Ã£o de parametrizaÃ§Ã£o
â”œâ”€â”€ getwf/                  # API REST
â”œâ”€â”€ shared_code/            # CÃ³digo compartilhado
â”‚   â”œâ”€â”€ brasileirao_serie_a_etl/  # LÃ³gica ETL especÃ­fica
â”‚   â”œâ”€â”€ functions.py        # FunÃ§Ãµes utilitÃ¡rias
â”‚   â”œâ”€â”€ variables.py        # ConfiguraÃ§Ãµes e constantes
â”‚   â””â”€â”€ connection_az.py    # ConexÃµes Azure
â”œâ”€â”€ .github/workflows/      # Pipelines CI/CD
â”œâ”€â”€ requirements.txt        # DependÃªncias Python
â””â”€â”€ host.json              # ConfiguraÃ§Ã£o Azure Functions
```

## âš™ï¸ ConfiguraÃ§Ã£o e Deploy

### PrÃ©-requisitos
- Python 3.9+
- Azure CLI
- Azure Functions Core Tools
- Conta Azure com Blob Storage

### Setup Local

1. **Clone o repositÃ³rio:**
```bash
git clone https://github.com/diogojacomini/worldfootball.git
cd worldfootball
```

2. **Crie e ative o ambiente virtual:**
```bash
# Windows
python -m venv .venv
.venv\Scripts\activate

# Linux/Mac
python -m venv .venv
source .venv/bin/activate
```

3. **Instale as dependÃªncias:**
```bash
pip install -r requirements.txt
```

4. **Configure as variÃ¡veis de ambiente:**
Crie um arquivo `local.settings.json`:
```json
{
    "IsEncrypted": false,
    "Values": {
        "AzureWebJobsStorage": "UseDevelopmentStorage=true",
        "FUNCTIONS_WORKER_RUNTIME": "python"
    }
}
```

5. **Execute localmente:**
```bash
func start
```

### Deploy para Azure

O projeto estÃ¡ configurado com CI/CD automÃ¡tico via GitHub Actions. Push para as branches `main` ou `develop` dispara o deploy automaticamente.

**Deploy manual:**
```bash
func azure functionapp publish <nome-da-function-app>
```

## ğŸ”„ Fluxo de ExecuÃ§Ã£o

1. **ParametrizaÃ§Ã£o**: Define temporada e rodada a serem processadas
2. **ExtraÃ§Ã£o**: Coleta dados da worldfootball.net
3. **TransformaÃ§Ã£o**: Limpa e estrutura os dados
4. **Carregamento**: Armazena na camada curated
5. **API**: Disponibiliza dados via endpoint REST

## ğŸ“¡ Endpoints da API

- **GET** `/api/getwf` - Retorna dados consolidados do BrasileirÃ£o

## ğŸ§ª Testes e Monitoramento

- Logs detalhados em cada etapa do pipeline
- Controle de status para retry automÃ¡tico
- ValidaÃ§Ã£o de parÃ¢metros de entrada
- Monitoramento via Azure Application Insights

## ğŸ¤ Contribuindo

1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/nova-feature`)
3. Commit suas mudanÃ§as (`git commit -m 'Adiciona nova feature'`)
4. Push para a branch (`git push origin feature/nova-feature`)
5. Abra um Pull Request

## ğŸ“ LicenÃ§a

Este projeto estÃ¡ sob a licenÃ§a MIT. Veja o arquivo [LICENSE](LICENSE) para detalhes.

## ğŸ”— Links Ãšteis

- [Azure Functions Documentation](https://learn.microsoft.com/pt-br/azure/azure-functions/)
- [Azure Functions Core Tools](https://learn.microsoft.com/pt-br/azure/azure-functions/functions-core-tools-reference)
- [World Football](https://www.worldfootball.net/)

---

**Desenvolvido por:** [Diogo Jacomini](https://github.com/diogojacomini)  
**Ãšltima atualizaÃ§Ã£o:** Julho 2025